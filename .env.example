# ChatFold Environment Configuration
# ====================================
# 这是唯一的环境配置模板和文档文件。
#
# 使用方法:
#   1. 复制此文件: cp .env.example .env.local
#   2. 根据需要修改 .env.local 中的配置
#   3. .env.local 不会被提交到 git
#   4. 重启开发服务器使配置生效
#
# 加载优先级: .env.{NODE_ENV} → .env.local
# 前端变量必须使用 NEXT_PUBLIC_ 前缀才能在浏览器中使用

# =============================================================================
# 环境配置
# =============================================================================

# 环境类型: development | test | production
NODE_ENV=development

# 环境标识: local-dev | test | production
ENVIRONMENT=local-dev

# 调试模式
DEBUG=true

# =============================================================================
# 应用端口
# =============================================================================

# 前端端口 (Next.js 开发服务器)
FRONTEND_PORT=3000

# 后端端口 (FastAPI/Uvicorn 服务器)
BACKEND_PORT=8000

# 前端主机名 (用于 CORS 和 URL 生成)
FRONTEND_HOST=localhost

# 后端主机名
BACKEND_HOST=localhost

# =============================================================================
# 生成的 URL (基于上面的端口/主机自动计算)
# =============================================================================

# 前端应用 URL
FRONTEND_URL=http://localhost:3000

# 后端 API 基础 URL (前端访问后端用)
NEXT_PUBLIC_BACKEND_URL=http://localhost:8000

# 后端 API 端点 URL (认证和 REST API 调用)
NEXT_PUBLIC_API_URL=http://localhost:8000/api/v1

# =============================================================================
# 后端服务器配置
# =============================================================================

HOST=0.0.0.0
PORT=8000

# 前端配置 (用于 CORS 自动生成)
FRONTEND_HOST=localhost
FRONTEND_PORT=3000

# =============================================================================
# 数据库配置
# =============================================================================

# 数据库类型: sqlite | mysql
# - sqlite: 本地开发，快速启动，无需 Docker 容器
# - mysql: 生产环境，需要 Docker 或远程数据库
DATABASE_TYPE=sqlite

# 可选：显式指定数据库 URL（会覆盖自动生成）
# SQLite: sqlite:///path/to/database.db
# MySQL: mysql+pymysql://user:pass@localhost:3306/chatfold
# DATABASE_URL=

# MySQL 配置（仅当 DATABASE_TYPE=mysql 时需要）
# MYSQL_HOST=localhost
# MYSQL_PORT=3306
# MYSQL_USER=chatfold
# MYSQL_PASSWORD=chatfold_dev
# MYSQL_DATABASE=chatfold

# =============================================================================
# Redis 配置
# =============================================================================

# Redis 类型: in_memory | redis
# - in_memory: 内存模拟 (FakeRedis)，无需外部服务（推荐用于本地开发）
# - redis: 真实 Redis 实例（Docker 容器、云托管等）
REDIS_TYPE=in_memory

# Redis 连接配置（仅当 REDIS_TYPE=redis 时需要）
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_INDEX=0

# =============================================================================
# 存储模式
# =============================================================================

# 内存模式（开发/测试用）
# true: 所有数据存储在内存，重启丢失
# false: 数据持久化到数据库
USE_MEMORY_STORE=false

# =============================================================================
# 外部服务配置
# =============================================================================

# NanoCC Scheduler API (蛋白质折叠编排服务)
# Scheduler URL - 用于实例分配和代理访问
NANOCC_SCHEDULER_URL=https://sd58janoglhtn7o3qa6r0.apigateway-cn-shanghai-inner.volceapi.com
# API Token - Bearer 认证令牌
NANOCC_AUTH_TOKEN=
# API 超时时间（秒）
NANOCC_TIMEOUT=120
# 文件系统根路径（vePFS）
# - 本地测试: /SPXvePFS/mewtool-test/sessions
# - volc-test: /SPXvePFS/mewtool/sessions
NANOCC_FS_ROOT=/SPXvePFS/mewtool-test/sessions

# NanoCC Mock 模式配置
# true: 使用 Mock 客户端（读取 JSONL 文件，不调用真实 API）
# false: 使用真实 NanoCC API
USE_MOCK_NANOCC=true
# Mock 消息延迟范围（秒）
MOCK_NANOCC_DELAY_MIN=1.0
MOCK_NANOCC_DELAY_MAX=5.0
# Mock 数据文件路径（可选，默认使用 tests/fixtures/Mocking_CoT.nanocc.jsonl）
# MOCK_NANOCC_DATA_PATH=

# =============================================================================
# TOS (火山云对象存储) 配置
# =============================================================================

# TOS 凭证 (用于文件上传)
# TOS_ACCESS_KEY=
# TOS_SECRET_KEY=
# TOS Endpoint (可选，有默认值)
# TOS_ENDPOINT=https://tos-s3-cn-shanghai.ivolces.com

# =============================================================================
# CORS 配置 (可选，后端会根据 FRONTEND_* 自动生成)
# =============================================================================

# 手动指定 CORS origins（会覆盖自动生成）
# CORS_ORIGINS=["http://localhost:3000","http://127.0.0.1:3000"]

# =============================================================================
# 端口配置示例
# =============================================================================

# 示例 1: 开发端口 (23000/28000)
# FRONTEND_PORT=23000
# BACKEND_PORT=28000
# NEXT_PUBLIC_BACKEND_URL=http://localhost:28000
# NEXT_PUBLIC_API_URL=http://localhost:28000/api/v1
# PORT=28000
# FRONTEND_PORT=23000

# 示例 2: 标准端口 (3000/8000) [默认]
# FRONTEND_PORT=3000
# BACKEND_PORT=8000

# 示例 3: 自定义端口 (避免冲突)
# FRONTEND_PORT=4000
# BACKEND_PORT=9000
# NEXT_PUBLIC_BACKEND_URL=http://localhost:9000
# NEXT_PUBLIC_API_URL=http://localhost:9000/api/v1
# PORT=9000
# FRONTEND_PORT=4000

# =============================================================================
# 快速开发模式
# =============================================================================

# 零依赖模式（无需 Docker，最快启动）：
# DATABASE_TYPE=sqlite
# REDIS_TYPE=in_memory
# USE_MEMORY_STORE=true  # 注意：数据不会持久化
# 启动命令: uv run uvicorn app.main:app --reload

# 持久化开发模式（无需 Docker，数据保留）：
# DATABASE_TYPE=sqlite
# REDIS_TYPE=in_memory
# USE_MEMORY_STORE=false
# 启动命令: uv run uvicorn app.main:app --reload

# 完整生产模拟模式（需要 Docker 容器）：
# DATABASE_TYPE=mysql
# REDIS_TYPE=redis
# USE_MEMORY_STORE=false
# DATABASE_URL=mysql+pymysql://chatfold:chatfold123@127.0.0.1:3306/chatfold
# 需先运行: ./scripts/local-dev/start.sh
# 启动命令: uv run uvicorn app.main:app --reload

# =============================================================================
# 生产环境覆盖
# =============================================================================
# 在生产环境中，以下值应通过环境变量或部署配置设置:
# - FRONTEND_URL: 生产前端域名
# - NEXT_PUBLIC_BACKEND_URL: 生产后端域名
# - DATABASE_URL: 生产数据库连接字符串
# - REDIS_HOST/REDIS_PORT: 生产 Redis 连接
